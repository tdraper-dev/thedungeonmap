(this.webpackJsonpmap_app_new_frontend=this.webpackJsonpmap_app_new_frontend||[]).push([[0],{125:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),r=n(63),o=n.n(r),s=(n(70),n(71),n(72),n(17)),i=n(5),u=n(2),l=n.n(u),d=n(4),b=n(3),m=n(6),j=n.n(m),p={login:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},f="/api/gameboards",x=null,g={setToken:function(e){x=e?"bearer ".concat(e):null},getGameBoards:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,c,a=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:null,n={headers:{Authorization:x},cancelToken:t},e.next=4,j.a.get(f,n);case 4:return c=e.sent,e.abrupt("return",c.data);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getGameBoard:function(){var e=Object(d.a)(l.a.mark((function e(t,n){var c,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={cancelToken:n},e.next=3,j.a.get("".concat(f,"/").concat(t),c);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),createGameBoard:function(){var e=Object(d.a)(l.a.mark((function e(t){var n,c,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:x,"Content-type":"multipart/form-data"}},(c=new FormData).append("myImage",t.mapImage),c.append("title",t.name),e.next=6,j.a.post(f,c,n);case 6:return a=e.sent,e.abrupt("return",a.data);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),updateGameBoardImage:function(){var e=Object(d.a)(l.a.mark((function e(t,n){var c,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(c=new FormData).append("myImage",t),e.next=4,j.a.put("".concat(f,"/").concat(n),c);case 4:return a=e.sent,e.abrupt("return",a.data);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),deleteGameBoard:function(){var e=Object(d.a)(l.a.mark((function e(t){var n,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("id",t),n={headers:{Authorization:x}},e.next=4,j.a.delete("".concat(f,"/").concat(t),n);case 4:return c=e.sent,e.abrupt("return",c.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),retrieveToken:function(){return x}},v={createUser:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.post("/api/users",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},h=n(0);function O(e){var t=e.errorType,n=k();return n.message&&n.errorType===t?Object(h.jsx)(w,{type:"errorMessage",notification:n.message}):null}function y(e){var t=e.successType,n=k();return n.message&&n.successType===t?Object(h.jsx)(w,{type:"successMessage",notification:n.message}):null}function w(e){var t=e.notification,n=e.type;return Object(h.jsx)("div",{className:"noselect ".concat(n),children:t})}var N=Object(c.createContext)();function I(e){var t=e.children,n=function(){var e=Object(c.useState)(""),t=Object(b.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(""),o=Object(b.a)(r,2),s=o[0],i=o[1],u=Object(c.useState)(""),l=Object(b.a)(u,2),d=l[0],m=l[1];return{message:n,errorType:s,successType:d,notify:function(e){var t=e.notification,n=e.errorType,c=e.successType;a(t),i(n||""),m(c||""),setTimeout((function(){a(""),i(""),m("")}),2e3)},notificationAlert:function(e){return console.log(e),e===s?Object(h.jsx)(O,{notification:n}):null}}}();return Object(h.jsx)(N.Provider,{value:n,children:t})}var k=function(){return Object(c.useContext)(N)};var B=Object(c.createContext)();function C(e){var t=e.children,n=function(){var e=Object(c.useState)(null),t=Object(b.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(""),o=Object(b.a)(r,2),s=o[0],i=o[1],u=k(),m=function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.login(t);case 3:n=e.sent,window.localStorage.setItem("loggedDungeonMaster",JSON.stringify(n)),g.setToken(n.token),a(n.id),i(n.username),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),u.notify({notification:"Username or Password Incorrect",errorType:"badCredentials"}),console.log("failure in useProvideAuth.logIn()",e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{window.localStorage.removeItem("loggedDungeonMaster"),g.setToken(null),a(null),i("")}catch(t){console.log("failed to logout",t)}case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.createUser(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){var e=function(){var e=window.localStorage.getItem("loggedDungeonMaster");if(e){var t=JSON.parse(e);a(t.id),i(t.username),g.setToken(t.token)}};return e(),function(){e()}}),[n]),{username:s,userId:n,logIn:m,logOut:j,signUp:f}}();return Object(h.jsx)(B.Provider,{value:n,children:t})}var S=function(){return Object(c.useContext)(B)};var T=n(36);var M=function(e){var t=Object(c.useState)(!1),n=Object(b.a)(t,2),r=n[0],o=n[1],s=Object(c.useRef)();return Object(h.jsxs)("div",{className:e.className,style:e.style,children:[Object(h.jsx)("button",{ref:s,onClick:function(){o(!r)},className:"buttons signUpButton",children:e.label}),r?a.a.cloneElement(e.children,Object(T.a)(Object(T.a)({},e),{},{visible:r,setVisible:o})):null]})};function E(e){var t=e.setVisible,n=Object(c.useState)(""),a=Object(b.a)(n,2),r=a[0],o=a[1],s=Object(c.useState)(""),u=Object(b.a)(s,2),l=u[0],d=u[1],m=Object(i.g)(),j=function(e){p.current&&p.current.contains(e.target)||t(!1)};Object(c.useEffect)((function(){return document.addEventListener("click",j),function(){document.removeEventListener("click",j)}}));var p=Object(c.useRef)();return Object(h.jsx)("div",{className:"joinSessionBox popUpBoxes",children:Object(h.jsxs)("form",{ref:p,className:"signUpForm row pt-3",onSubmit:function(e){return e.preventDefault(),t(!1),m.push({pathname:"/gameboard/".concat(r),from:"/",state:{username:l,id:Math.random()}})},children:[Object(h.jsx)("label",{className:"label col-lg-7 col-md-6 col-8 mb-2",children:"Player Name"}),Object(h.jsx)("input",{type:"text",value:l,onChange:function(e){var t=e.target;return d(t.value)},className:"submitButtons col-lg-6 col-md-6 col-8 mb-2 inputs"}),Object(h.jsx)("label",{className:"label col-lg-7 col-md-6 col-8 mb-2",children:"Session ID"}),Object(h.jsx)("input",{type:"text",value:r,onChange:function(e){var t=e.target;return o(t.value)},className:"submitButtons col-lg-6 col-md-6 col-8 mb-2 inputs"}),Object(h.jsx)("button",{className:"col-lg-4 col-md-6 col-8 mb-2 submitButtons buttons",type:"submit",children:"Join!"})]})})}function D(e){e.setUser;var t=Object(c.useState)(""),n=Object(b.a)(t,2),a=n[0],r=n[1],o=Object(c.useState)(""),s=Object(b.a)(o,2),i=s[0],u=s[1],m=S(),j=function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault();try{n={username:a,password:i},m.logIn(n)}catch(c){console.log(c)}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsxs)("form",{className:"loginForm row py-5",onSubmit:j,children:[Object(h.jsx)("label",{className:"label col-lg-6 col-md-6 col-8",children:"Username"}),Object(h.jsx)("input",{type:"text",placeholder:"Username",className:"col-lg-6 col-md-6 col-8 mt-2 mb-4 inputs",value:a,onChange:function(e){var t=e.target;return r(t.value)}}),Object(h.jsx)("label",{className:"label col-lg-6 col-md-6 col-8",children:"Password"}),Object(h.jsx)("input",{type:"password",placeholder:"Password",className:"col-lg-6 col-md-6 col-8 mt-2 mb-4 inputs",value:i,onChange:function(e){var t=e.target;return u(t.value)}}),Object(h.jsxs)("div",{className:"notifyBoxes col-lg-6 col-md-6 col-8 mb-2",children:[Object(h.jsx)("button",{className:"buttons",type:"submit",children:"Login"}),Object(h.jsx)(O,{errorType:"badCredentials"})]})]})}function L(e){var t=e.setVisible,n=e.handleSignUp,a=Object(c.useState)(""),r=Object(b.a)(a,2),o=r[0],s=r[1],i=Object(c.useState)(""),u=Object(b.a)(i,2),l=u[0],d=u[1],m=Object(c.useState)(""),j=Object(b.a)(m,2),p=j[0],f=j[1],x=Object(c.useRef)(),g=k(),v=function(e){x.current&&x.current.contains(e.target)||t(!1)};return Object(c.useEffect)((function(){return document.addEventListener("click",v),function(){document.removeEventListener("click",v)}})),Object(h.jsxs)("form",{ref:x,className:"signUpForm row pt-3",onSubmit:function(e){e.preventDefault(),l===p?n(o,l):g.notify({notification:"Please ensure passwords match",errorType:"passwordMatch"})},children:[Object(h.jsx)("label",{className:"label col-lg-6 col-md-8 col-8 mb-2",children:"Username"}),Object(h.jsx)("input",{type:"text",className:"col-lg-6 col-md-8 col-8 mb-2 inputs",value:o,onChange:function(e){var t=e.target;return s(t.value)}}),Object(h.jsx)(O,{errorType:"usernameLength"}),Object(h.jsx)("label",{className:"label col-lg-6 col-md-8 col-8 mb-2",children:"Password"}),Object(h.jsx)("input",{type:"password",className:"col-lg-6 col-md-8 col-8 mb-2 inputs",value:l,onChange:function(e){var t=e.target;return d(t.value)}}),Object(h.jsx)("label",{className:"label col-lg-6 col-md-8 col-8 mb-2",children:"Confirm Password"}),Object(h.jsx)("input",{type:"password",className:"col-lg-6 col-md-8 col-8 mb-2 inputs",value:p,onChange:function(e){var t=e.target;return f(t.value)}}),Object(h.jsxs)("div",{className:"notifyBoxes col-lg-6 col-md-8 col-8 mb-2 pt-2",children:[Object(h.jsx)("button",{className:"buttons",type:"submit",children:"Sign Up"}),Object(h.jsx)(O,{errorType:"passwordMatch"})]})]})}function U(e){var t=e.setVisible,n=k(),c=S(),a=function(){var e=Object(d.a)(l.a.mark((function e(a,r){var o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o={username:a,password:r},e.next=4,c.signUp(o);case 4:e.sent&&(t(!1),n.notify({notification:"New user ".concat(a," created!"),successType:"userCreated"})),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),n.notify({notification:"Username taken or under 5 character mininmum length",errorType:"usernameLength"}),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}();return Object(h.jsx)("div",{className:"signUpBox popUpBoxes",children:Object(h.jsx)(L,{setVisible:t,handleSignUp:a})})}var F=function(){return Object(h.jsxs)("div",{id:"background",children:[Object(h.jsx)("h1",{className:"noselect loginTitle",children:"Dungeon Map!"}),Object(h.jsx)("div",{className:"loginContainer row mx-3",children:Object(h.jsxs)("div",{className:"loginBox notifyBoxes d-flex",children:[Object(h.jsx)("h2",{className:"noselect titles formTitle",children:"Login"}),Object(h.jsx)(D,{}),Object(h.jsxs)("div",{className:" otherOptions d-flex mx-2",children:[Object(h.jsx)(M,{label:"Sign Up",className:"optionItems px-1 py-1",children:Object(h.jsx)(U,{})}),Object(h.jsx)(M,{label:"Join Game",className:"optionItems px-1 py-1",children:Object(h.jsx)(E,{})})]}),Object(h.jsx)(y,{successType:"userCreated"})]})})]})},R=n(18);var P=function(e){return function(e){var t=Uint8Array.from(e).buffer,n=new Blob([t]);return new Promise((function(e,t){var c=new FileReader;c.readAsDataURL(n),c.onload=function(){e(this.result)}}))}(e).then((function(e){return e}))};var _=function(e){var t=e.color;return Object(h.jsx)("div",{style:{backgroundColor:"".concat(t)},className:" specialBounce AddContentCircle",children:Object(h.jsx)("div",{className:"noselect AddContentCircleText d-flex",children:"Add content"})})},G=function(){return Object(h.jsx)("div",{className:"loadingSquare",children:Object(h.jsx)("div",{className:"noselect loadingSquareText d-flex",children:"Loading"})})};var A,V=function(e){var t=e.children,n=e.position,a=e.updatePosition,r=e.deleteIcon,o=e.id,s=Object(c.useState)({x:n.x,y:n.y}),i=Object(b.a)(s,2),u=i[0],l=i[1],d=Object(c.useRef)(),m=Object(c.useRef)({x:0,y:0}),j=function(e){var t=document.getElementById("aspectRatioBoxBoard").getBoundingClientRect();d.current.style.left="".concat((e.clientX+m.current.x-t.left)/t.width*100,"%"),d.current.style.top="".concat((e.clientY+m.current.y-t.top)/t.height*100,"%"),e.stopPropagation(),e.preventDefault()},p=function e(t){var n=d.current.getBoundingClientRect();if(n.x<50&&n.y<50)try{r(o),d.current.style.display="none"}catch(c){console.log("Unable to delete icon",c)}else u.x!==d.current.style.left&&u.y!==d.current.style.top&&l({x:d.current.style.left,y:d.current.style.top});m.current={x:0,y:0},window.removeEventListener("pointermove",j),window.removeEventListener("pointerup",e),t.stopPropagation(),t.preventDefault()},f=function(e){e.preventDefault()};Object(c.useEffect)((function(){var e=d.current;return e.addEventListener("touchmove",f,{passive:!1}),function(){window.removeEventListener("pointerup",p),e.removeEventListener("touchmove",f,{passive:!1}),window.removeEventListener("pointermove",j),window.removeEventListener("pointerup",p)}}),[]);var x=Object(c.useRef)(!0);return Object(c.useEffect)((function(){x.current||a({x:u.x,y:u.y},o)}),[u.x,u.y]),Object(c.useEffect)((function(){x.current=!1}),[]),Object(h.jsx)("div",{onPointerDown:function(e){var t=d.current.getBoundingClientRect(),n=t.left,c=t.top;m.current={x:n-e.clientX,y:c-e.clientY},window.addEventListener("pointermove",j),window.addEventListener("pointerup",p),e.stopPropagation(),e.preventDefault()},style:{top:n.y,left:n.x},className:"draggableBox",ref:d,children:t})},Y="/api/icons",q={getIcons:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.get("".concat(Y,"/").concat(t));case 2:return n=e.sent,console.log("ICONS ",n.data),e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),createIcon:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.post(Y,t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),updateIcon:function(){var e=Object(d.a)(l.a.mark((function e(t,n){var c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.put("".concat(Y,"/").concat(n),t);case 2:return c=e.sent,e.abrupt("return",c.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),deleteIcon:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,j.a.delete("".concat(Y,"/").concat(t));case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},J=n(35),z=n.n(J),H=function(){A&&(console.log("Disconnecting socket..."),A.disconnect(),A=null,console.log("THE SOCKET",A))},K={initiateDMSocket:function(e){console.log("Dungeon Master connecting to socket..."),A=z()(),console.log("DMsocket",A),A.emit("join",{boardId:e,username:"DungeonMaster"}),A.on("user_joined"),A.on("user_disconnect")},initiateGuestSocket:function(e,t,n,c){console.log("Guest connecting to socket..."),(A=z()()).emit("guest",e),A.on("guestCheck",(function(a){return a?(console.log("Guest registering to Room"),A.emit("join",{boardId:e,username:n}),A.on("dm_disconnect",(function(){return console.log("The guests have received notice from the Server, the DM is gone"),H(),t.goBack()})),c()):(console.log("no access!"),A.disconnect(),t.goBack())}))},userEntryExit:function(e){A&&(A.on("user_joined",(function(t){e(t)})),A.on("user_disconnect",(function(t){e(t)})))},disconnectSocket:H,dmDisconnecting:function(){A&&(console.log('The DM is sending "dm_disconnecting" to the Server'),A.emit("dm_disconnecting"))},createIcon:function(e){A&&(console.log("you want to create this icon",e),A.emit("create_icon",e))},addIcon:function(e){A&&A.on("add_icon",(function(t){return console.log("Creating this icon",t),e(t)}))},moveIcon:function(e,t){A&&(console.log("You want to move this icon",t),A.emit("move_icon",{iconPosition:e,iconId:t}))},updateIcon:function(e){A&&A.on("icon_updated",(function(t){var n=t.iconPosition,c=t.iconId;return console.log("Moving this icon",c),e(n,c)}))},deleteIcon:function(e){A&&(console.log("You want to delete this icon",e),A.emit("delete_icon",e))},clearIcon:function(e){A&&A.on("clear_icon",(function(t){console.log("Removing this icon: ",t),e(t)}))},changeMap:function(){A&&(console.log("You want to change the map image"),A.emit("change_map"))},updateMap:function(e){A&&A.on("update_map",(function(){return e()}))},sendMessage:function(e){A&&(console.log("You want to send a message"),A.emit("send_message",e))},receiveMessage:function(e){A&&A.on("receive_message",(function(t){return console.log("receiving new message!"),e(t)}))}};var W=function(e){var t=e.style,n=e.content,c=e.id,a=e.position,r=e.display,o=void 0!==r&&r,s=e.deleteIcon,i=e.updatePosition;return Object(h.jsx)(h.Fragment,{children:o?Object(h.jsx)("div",{className:"draggableBox",style:{top:a.y,left:a.x},children:Object(h.jsx)("div",{style:t,className:"noselect playerIcon",children:n})}):Object(h.jsx)(V,{updatePosition:i,deleteIcon:s,position:a,id:c,children:Object(h.jsx)("div",{style:t,className:"noselect playerIcon",children:n})})})};function X(){var e=S();return Object(h.jsx)("div",{className:"logoutBox optionItems px-1 py-1 col-6",children:Object(h.jsx)("button",{className:"buttons logOutButton",onClick:function(){return e.logOut()},children:"Logout"})})}function Z(e){var t=Object(c.useState)(!1),n=Object(b.a)(t,2),a=n[0],r=n[1],o=e.label,s=e.className;return Object(h.jsxs)("div",{onMouseEnter:function(){return r(!0)},onMouseLeave:function(){return r(!1)},className:"".concat(s," my-2"),children:[e.children,a?Object(h.jsx)("div",{className:"popUpVisible",children:o}):null]})}function Q(e){var t=e.thisBoard,n=e.gameBoards,a=e.setBoards,r=e.setBoardId,o=(e.loading,e.setLoading),i=Object(c.useState)(""),u=Object(b.a)(i,2),m=u[0],j=u[1],p=Object(c.useRef)(),f=function(){var e=Object(d.a)(l.a.mark((function e(){var c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!window.confirm("Do you want to delete this board?")){e.next=9;break}return o(!0),e.next=5,g.deleteGameBoard(t.id);case 5:c=n.filter((function(e){return e.id!==t.id})),a(c),o(!1),c.length>0&&document.getElementsByClassName("thumbnailBox")[c.length-1].click();case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),x=function(e){if(r(t.id),!p.current.hasAttribute("id")){var n=document.getElementById("highlightSelect");n&&n.removeAttribute("id"),p.current.setAttribute("id","highlightSelect")}};return Object(c.useEffect)((function(){P(t.thumbnail.data).then((function(e){return j(e)})).catch((function(e){return console.log(e)}));document.getElementsByClassName("thumbnailBox")[0].click()}),[]),Object(h.jsxs)("div",{ref:p,className:"boardTile row ".concat(t.board),children:[Object(h.jsx)("div",{onClick:x,className:"boardTitle pe-0 d-flex col-4",children:Object(h.jsx)("div",{className:"boardTitleText",children:t.board})}),Object(h.jsx)("div",{onClick:x,className:"thumbnailBox col-6 py-2 ps-3",children:Object(h.jsx)("img",{alt:"Gameboard Map minified view",draggable:"false",className:"thumbnailImage img-fluid",src:m})}),Object(h.jsxs)("div",{className:"buttonContainer ps-0 pe-0 col-2 row",children:[Object(h.jsx)(Z,{label:"Delete Gameboard",className:"ps-0 deleteButton",children:Object(h.jsx)(R.d,{className:"deleteIcon",onClick:f})}),Object(h.jsx)(Z,{label:"Host Gameboard",className:"ps-0  enterButton",children:Object(h.jsx)(s.b,{className:"toGameboardLink",to:"/gameboard/".concat(t.id),children:Object(h.jsx)(R.b,{className:"enterIcon"})})})]})]})}function $(e){return Object(h.jsx)("div",{className:"boardsDisplay",children:e.children})}function ee(e){var t=e.setVisible,n=e.createNewBoard,a=Object(c.useState)(""),r=Object(b.a)(a,2),o=r[0],s=r[1],i=Object(c.useRef)(),u=Object(c.useRef)(),m=/image\/(png|jpeg)/,j=function(){var e=Object(d.a)(l.a.mark((function e(c){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c.preventDefault(),e.prev=1,a=u.current.files[0],!m.test(a.type)){e.next=10;break}return console.log("success!"),t(!1),e.next=8,n(o,a);case 8:e.next=11;break;case 10:throw new Error({message:"wrong file type!"});case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}(),p=function(e){i.current&&i.current.contains(e.target)||t(!1)};return Object(c.useEffect)((function(){return document.addEventListener("click",p),function(){document.removeEventListener("click",p)}})),Object(h.jsx)("div",{ref:i,className:"newBoardFormBox popUpBoxes py-2 px-2",children:Object(h.jsxs)("form",{id:"uploadFormDash",className:"row py-3 px-3",encType:"multipart/form-data",onSubmit:j,children:[Object(h.jsx)("label",{className:"label newMapNameLabel",children:"Board Name:"}),Object(h.jsx)("input",{type:"text",className:"inputs pb-2 newMapName col-10 my-2",value:o,onChange:function(e){var t=e.target;return s(t.value)},required:!0,autoFocus:!0}),Object(h.jsx)("label",{htmlFor:"fileUploadDash",className:"col-4 px-1 py-1 mb-2 fileUpload submitButtons buttons",children:"Upload Image"}),Object(h.jsx)("input",{type:"file",className:"inputs newMapName",ref:u,id:"fileUploadDash",name:"file",required:!0}),Object(h.jsx)("button",{className:"col-6 mt-4 submitButtons buttons",type:"submit",children:"Create"})]})})}function te(e){return Object(h.jsx)("div",{className:"dmButtonsBox d-flex",children:e.children})}function ne(){var e=S();return Object(h.jsx)("div",{className:"userBlock pt-1 pb-1 pt-lg-3 pb-lg-3 row",children:Object(h.jsxs)("div",{className:"dashTitle col-12",children:[Object(h.jsx)("p",{className:"titleName",children:"Dungeon Master:"}),Object(h.jsx)("p",{className:"titleName ms-2 ms-lg-0",children:e.username})]})})}function ce(e){return Object(h.jsx)("div",{className:"sideBarColumn col-12 col-lg-2 d-flex",children:e.children})}function ae(e){var t=e.displayImage,n=e.boardId,c=e.icons;return Object(h.jsx)("div",{className:"mapImageView col-9 col-md-8 d-flex",children:Object(h.jsx)("div",{className:"imageBox d-flex",children:Object(h.jsxs)("div",{id:"aspectRatioBoxTray",children:[c.map((function(e){return Object(h.jsx)(W,{style:{backgroundColor:e.color},content:e.content,id:e.id,position:e.position,display:!0},e.id)})),Object(h.jsx)("img",{draggable:"false",className:"dashMapImage mapImage img-fluid",alt:"",src:t},n)]})})})}function re(e){return Object(h.jsx)("div",{className:"mapTrayContainer col-12 col-lg-10  d-flex",children:e.children})}var oe=function(){var e=Object(c.useState)([]),t=Object(b.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(""),o=Object(b.a)(r,2),s=o[0],i=o[1],u=Object(c.useState)(null),m=Object(b.a)(u,2),p=m[0],f=m[1],x=Object(c.useState)([]),v=Object(b.a)(x,2),O=v[0],y=v[1],w=Object(c.useState)(!0),N=Object(b.a)(w,2),I=N[0],k=N[1],B=function(){var e=Object(d.a)(l.a.mark((function e(t,c){var r,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k(!0),e.prev=1,r={name:t,mapImage:c},e.next=5,g.createGameBoard(r);case 5:if(!(o=e.sent)){e.next=12;break}return e.next=9,C(o);case 9:a(n.concat(o)),k(!1),document.getElementsByClassName("thumbnailBox")[n.length].click();case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t,n){return e.apply(this,arguments)}}(),C=function(e){P(e.dashImage.data).then((function(e){f(e)})).catch((function(e){return console.log("error with updating dash",e.message)}))};return Object(c.useEffect)((function(){var e=j.a.CancelToken.source();return function(){var t=Object(d.a)(l.a.mark((function t(){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return k(!0),t.prev=1,t.next=4,g.getGameBoards(e.token);case 4:if(n=t.sent,a(n),!(n.length>0)){t.next=14;break}if(!n[0].dashImage){t.next=12;break}return t.next=10,C(n[0]);case 10:y(n[0].icons),k(!1);case 12:t.next=15;break;case 14:k(!1);case 15:t.next=20;break;case 17:t.prev=17,t.t0=t.catch(1),console.log(t.t0);case 20:case"end":return t.stop()}}),t,null,[[1,17]])})));return function(){return t.apply(this,arguments)}}()(),function(){e.cancel()}}),[]),Object(c.useEffect)((function(){var e=function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k(!0),e.prev=1,!t){e.next=9;break}if(!(n=t.find((function(e){return e.id===s})))||!n.dashImage){e.next=9;break}return e.next=7,C(n);case 7:y(n.icons),k(!1);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}();return e(n),function(){return e()}}),[s]),Object(h.jsxs)("div",{className:"row dashboardRow",children:[Object(h.jsxs)(ce,{children:[Object(h.jsx)(ne,{}),Object(h.jsxs)(te,{children:[Object(h.jsx)(M,{label:"Create",className:"optionItems col-6 px-1 py-1 buttonFix",children:Object(h.jsx)(ee,{createNewBoard:B})}),Object(h.jsx)(X,{})]}),Object(h.jsx)($,{children:n.map((function(e){return Object(h.jsx)(Q,{gameBoards:n,setBoards:a,thisBoard:e,setBoardId:i,loading:I,setLoading:k},e.id)}))})]}),Object(h.jsx)(re,{children:I?Object(h.jsx)(G,{}):n.length>0?Object(h.jsx)(ae,{boardId:s,displayImage:p,icons:O}):Object(h.jsx)("div",{onClick:function(){document.getElementsByClassName("signUpButton")[0].click()},className:"addContentBox",children:Object(h.jsx)(_,{color:"rgb(187, 0, 0)"})})})]})},se=n(65);function ie(e){var t=e.createIcon,n=e.boardId,a=e.visible,r=Object(c.useState)(""),o=Object(b.a)(r,2),s=o[0],i=o[1],u=Object(c.useState)("rgba(250,235,215,1)"),l=Object(b.a)(u,2),d=l[0],m=l[1];return Object(h.jsx)("div",{className:"".concat(a?"visibleTool ":"","buildIconFormBox"),children:Object(h.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t({content:s,color:d,boardId:n}),i(""),document.getElementById("iconContentInput").blur()},className:"changeMapRow row mt-5",children:[Object(h.jsx)("label",{className:"col-4 mb-1",htmlFor:"iconContentInput",children:"Content: "}),Object(h.jsx)("input",{id:"iconContentInput",type:"text",value:s,onChange:function(e){var t=e.target;return i(t.value)},onFocus:function(e){var t=e.target;window.innerWidth<420&&(t.style.transform="translateY(-460%)"),t.setAttribute("autocomplete","off")},onBlur:function(e){e.target.style.transform="translateY(0%)"},required:!0,className:"col-8",autoComplete:"new-password"}),Object(h.jsx)("label",{className:"col-4 my-1",htmlFor:"iconColorInput",children:"Color: "}),Object(h.jsxs)("select",{className:"col-4",name:"colors",id:"iconColorInput",onChange:function(e){var t=e.target;return m(t.value)},children:[Object(h.jsx)("option",{value:"rgba(250,235,215,1)",defaultValue:!0,children:"White"}),Object(h.jsx)("option",{style:{backgroundColor:"rgba(191, 63, 63, 1)"},value:"rgba(191, 63, 63, 1)",children:"Red"}),Object(h.jsx)("option",{style:{backgroundColor:"rgba(63,127,191,1"},value:"rgba(63,127,191,1)",children:"Blue"}),Object(h.jsx)("option",{style:{backgroundColor:"rgba(63,191,63,1)"},value:"rgba(63,191,63,1)",children:"Green"})]}),Object(h.jsx)("button",{className:"ms-2 mt-3 col-6 submitButtonFix",type:"submit",children:"Create Icon"})]})})}function ue(e){var t=e.setLoading,n=e.boardId,a=e.setImage64,r=e.visible,o=function(){var e=Object(d.a)(l.a.mark((function e(c){var r,o,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.preventDefault(),t(!0),r=s.current.files[0],e.next=5,g.updateGameBoardImage(r,n);case 5:return o=e.sent,e.next=8,P(o.data);case 8:return(i=e.sent)&&K.changeMap(),e.next=12,a(i);case 12:t(!1);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s=Object(c.useRef)();return Object(h.jsxs)("form",{id:"uploadForm",className:"mt-5 ".concat(r?"visibleTool ":""),encType:"multipart/form-data",onSubmit:o,children:[Object(h.jsx)("label",{htmlFor:"fileUpload",className:"fileUpload px-2 mx-2",children:"Select Image"}),Object(h.jsx)("input",{ref:s,type:"file",id:"fileUpload",name:"file",required:!0}),Object(h.jsx)("input",{type:"submit",value:"Upload"})]})}var le=function(e){var t=e.icons,n=e.setIcons,a=e.setImage64,r=e.setLoading,o=e.boardId,s=e.float,i=e.setFloat,u=Object(c.useState)(""),m=Object(b.a)(u,2),j=m[0],p=m[1],f=Object(c.useState)(!0),x=Object(b.a)(f,2),g=x[0],v=x[1],O=function(){var e=Object(d.a)(l.a.mark((function e(c){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q.createIcon(c);case 2:a=e.sent,K.createIcon(a),n(t.concat(a));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=null;return"changeMap"===j?y=Object(h.jsx)(ue,{setLoading:r,boardId:o,setImage64:a}):"buildIcon"===j&&(y=Object(h.jsx)(ie,{createIcon:O,boardId:o})),Object(h.jsxs)("div",{id:"dungeonMasterSideBar","aria-label":"sidebar","aria-hidden":g,className:"sidebar row",children:[Object(h.jsx)("div",{onClick:function(){v(!g),i(!s)},className:" dmArmBox buttonArmBox",children:Object(h.jsx)("div",{className:"noselect toggleClickBox dmClickBox",children:"Tools"})}),Object(h.jsx)("div",{className:"toolBarRow row",children:Object(h.jsxs)("div",{className:"toolButtonBar col-12 ps-0 pe-0",children:[Object(h.jsx)("button",{onClick:function(){return p("changeMap")},className:"changeMap",children:"Change Map"}),Object(h.jsx)("button",{onClick:function(){return p("buildIcon")},className:"addIcon",children:"Add Icon"})]})}),Object(h.jsx)("div",{className:"row",children:y})]})},de=function(e){var t=e.content;return Object(h.jsx)("div",{className:"systemMessage px-2 mb-2",children:Object(h.jsx)("div",{className:"",children:t})})},be=function(e){var t=e.sender,n=e.content;return Object(h.jsxs)("div",{className:"meMsgPacket mb-4",children:[Object(h.jsx)("div",{className:"meMsgInitial msgInitial",children:t}),Object(h.jsx)("div",{className:"msg meMsg",children:n})]})},me=function(e){var t=e.sender,n=e.content;return Object(h.jsxs)("div",{className:"otherMsgPacket mb-4",children:[Object(h.jsx)("div",{className:"otherMsgInitial msgInitial",children:t}),Object(h.jsx)("div",{className:"msg otherMsg",children:n})]})};var je=function(e){var t=e.id,n=e.username,a=e.session,r=e.float,o=e.setFloat,s=Object(c.useState)(!0),i=Object(b.a)(s,2),u=i[0],l=i[1],d=Object(c.useState)(""),m=Object(b.a)(d,2),j=m[0],p=m[1],f=Object(c.useState)([]),x=Object(b.a)(f,2),g=x[0],v=x[1],O=Object(c.useRef)(null),y=Object(c.useRef)(null);return Object(c.useEffect)((function(){a&&K.receiveMessage((function(e){v((function(t){return t.concat(e)})),O.current.id="blueCircleBounce",setTimeout((function(){O.current.id=""}),1e3)}))}),[a]),Object(c.useEffect)((function(){y.current.scrollIntoView({behavior:"smooth"})})),Object(h.jsxs)("div",{id:"messengerSideBar","aria-label":"sidebar","aria-hidden":u,className:"sidebar row msgRow",children:[Object(h.jsx)("div",{className:"buttonArmBox msgArmBox",children:Object(h.jsx)("div",{ref:O,onClick:function(){l(!u),o(!r)},className:"noselect toggleClickBox msgClickBox",children:"Chat"})}),Object(h.jsxs)("div",{className:"messageBox",children:[g.map((function(e){return e.systemMsg?Object(h.jsx)(de,{content:e.content},e.id):t===e.userId?Object(h.jsx)(be,{sender:n,content:e.content},e.id):Object(h.jsx)(me,{sender:e.username,content:e.content},e.id)})),Object(h.jsx)("div",{ref:y})]}),Object(h.jsx)("div",{className:"sendMessageBox",children:Object(h.jsxs)("form",{className:"messageTextBox",onSubmit:function(e){if(e.preventDefault(),j){var c={id:Math.random(),userId:t,username:n,content:j,systemMsg:!1};v(g.concat(c)),K.sendMessage(c),p("")}},id:"textMsgForm",children:[Object(h.jsx)("textarea",{id:"chatMessageBox",className:"textAreaBox",value:j,onChange:function(e){var t=e.target;return p(t.value)},onKeyDown:function(e){"Enter"===e.key&&(e.preventDefault(),document.getElementById("textMsgForm").requestSubmit())}}),Object(h.jsx)("button",{type:"submit",className:"pb-1 submitMessageButton",children:Object(h.jsx)(R.a,{size:"50%"})})]})})]})};function pe(e){var t=e.float;return Object(h.jsx)("div",{className:"gameboardMapImageView mapImageView col-11 d-flex",children:Object(h.jsx)("div",{className:"".concat(t?"floating":""," gameboardImageBox mt-3 mb-5 d-flex"),children:Object(h.jsx)("div",{id:"aspectRatioBoxBoard",children:e.children})})})}function fe(e){var t=e.mapSrc,n=e.loading,c=e.icons,a=e.setIcons,r=e.deleteIcon,o=e.updatePosition,s=e.float;return Object(h.jsxs)("div",{className:"mapTrayGameBoard col-12 py-5 px-5 d-flex",children:[Object(h.jsx)("div",{id:"dropZoneDelete",className:"d-flex",children:Object(h.jsx)("p",{className:"noselect pt-3",children:"Delete"})}),n?Object(h.jsx)(G,{}):Object(h.jsxs)(pe,{float:s,children:[c.map((function(e){return Object(h.jsx)(W,{style:{backgroundColor:e.color},content:e.content,id:e.id,position:e.position,setIcons:a,icons:c,deleteIcon:r,updatePosition:o},e.id)})),Object(h.jsx)("img",{draggable:"false",id:"gameBoardMap",className:"noselect gameboardMapImage mapImage img-fluid",alt:"",src:t})]})]})}function xe(e){var t=e.userId,n=e.sessionLive,c=e.connectToSocket,a=e.history,r=e.boardId;return Object(h.jsxs)("div",{className:"dropMenuContainer row",children:[Object(h.jsx)("div",{className:" dropTile col-12",children:Object(h.jsx)("button",{className:" dropButton",onClick:function(){return a.goBack()},children:t?"Dashboard":"Home"})}),t?Object(h.jsx)("div",{className:" col-12 dropTile sessionButtonTile ".concat(n&&t?"tweak":""),children:Object(h.jsx)("button",{onClick:c,className:"".concat(n&&t?"tweak":""," dropButtonSession"),children:n?"End Session":"Start Session"})}):null,n&&t?Object(h.jsxs)("div",{id:"sessionIdBox",children:[Object(h.jsx)("span",{className:" ms-5 ps-2",children:"Session ID: "}),r]}):null]})}function ge(e){var t=e.sessionLive,n=e.history,a=e.connectToSocket,r=e.boardId,o=Object(c.useState)(!1),s=Object(b.a)(o,2),i=s[0],u=s[1],l=Object(c.useRef)(),d=S(),m=d.userId?d.userId:null,j=function(e){e.target===l.current&&u(!i),l.current&&l.current.contains(e.target)||u(!1)};return Object(c.useEffect)((function(){return document.addEventListener("click",j),function(){document.removeEventListener("click",j)}})),Object(h.jsxs)("div",{ref:l,onClick:j,className:"".concat(t?"activeBurger":""," ").concat(i?"openMenu":""),id:"hamburger",children:[Object(h.jsx)(R.c,{className:"hide",size:"20px"}),i?Object(h.jsx)(xe,{userId:m,sessionLive:t,history:n,connectToSocket:a,boardId:r}):null]})}var ve=function(e){var t=Object(c.useState)(""),n=Object(b.a)(t,2),a=n[0],r=n[1],o=Object(c.useState)([]),s=Object(b.a)(o,2),u=s[0],m=s[1],p=Object(c.useState)(!1),f=Object(b.a)(p,2),x=f[0],v=f[1],O=Object(c.useState)(!1),y=Object(b.a)(O,2),w=y[0],N=y[1],I=Object(c.useState)(!1),B=Object(b.a)(I,2),C=B[0],T=B[1],M=S(),E=k(),D=e.match.params.id,L=Object(i.g)(),U=Object(i.h)(),F={id:"",username:""};U.state&&(F={id:U.state.id,username:U.state.username});var R=function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:!1===w?(M.userId&&K.initiateDMSocket(D),K.userEntryExit((function(e){"userConnect"===e&&E.notify({notification:"New user has joined the game!",errorType:null,successType:"newUserJoined"}),"userDisconnect"===e&&E.notify({notification:"User has left the game!",errorType:"userExit",successType:null})})),K.addIcon((function(e){m((function(t){return[].concat(Object(se.a)(t),[e])}))})),K.updateIcon((function(e,t){m((function(n){return n.map((function(n){return n.id===t&&(n.position.x=e.x,n.position.y=e.y),n}))}))})),K.clearIcon((function(e){console.log("removing this id",e),m((function(t){return t.filter((function(t){return t.id!==e}))}))})),K.updateMap(Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v(!0),e.next=3,g.getGameBoard(D);case 3:return t=e.sent,e.next=6,P(t.image.data);case 6:n=e.sent,r(n),n&&v(!1);case 9:case"end":return e.stop()}}),e)})))),N(!0)):(K.dmDisconnecting(),N(!1));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_=function(){var e=Object(d.a)(l.a.mark((function e(t,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return K.moveIcon(t,n),e.next=3,q.updateIcon(t,n);case 3:e.sent,m((function(e){return e.map((function(e){return e.id===n&&(e.position.x=t.x,e.position.y=t.y),e}))}));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),G=function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q.deleteIcon(t);case 2:K.deleteIcon(t),m((function(e){return e.filter((function(e){return e.id!==t}))}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){var e=j.a.CancelToken.source(),t=function(){var t=Object(d.a)(l.a.mark((function t(){var n,c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,v(!0),t.next=4,g.getGameBoard(D,e.token);case 4:return n=t.sent,t.next=7,P(n.image.data);case 7:c=t.sent,r(c),m(n.icons),v(!1),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),console.log("loading mapImage failed",t.t0);case 16:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(){return t.apply(this,arguments)}}(),n=function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Authorizing guest. . ."),K.initiateGuestSocket(D,L,F.username,t);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return M.userId?t():(n(),R()),function(){e.cancel(),K.disconnectSocket()}}),[]),Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("div",{className:"gameBoardRow row",children:[Object(h.jsx)(ge,{sessionLive:w,history:L,connectToSocket:R,boardId:D}),Object(h.jsx)(fe,{deleteIcon:G,mapSrc:a,loading:x,icons:u,setIcons:m,updatePosition:_,float:C})]}),M.userId?Object(h.jsx)(le,{setLoading:v,boardId:D,setImage64:r,icons:u,setIcons:m,float:C,setFloat:T}):null,Object(h.jsx)(je,{id:F.id||M.userId,username:F.username||M.username,session:w,float:C,setFloat:T})]})};var he=function(){var e=S();return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(i.b,{path:"/",render:function(){return e.userId?Object(h.jsx)(i.a,{from:"/",to:"/dashboard"}):Object(h.jsx)(i.a,{from:"/",to:"/login"})}}),Object(h.jsxs)(i.d,{children:[Object(h.jsx)(i.b,{path:"/dashboard",component:oe}),Object(h.jsx)(i.b,{path:"/login",component:F}),Object(h.jsx)(i.b,{path:"/gameboard/:id",component:ve})]})]})};var Oe=function(){return Object(h.jsx)(s.a,{children:Object(h.jsx)(I,{children:Object(h.jsx)(C,{children:Object(h.jsx)(he,{})})})})},ye=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,126)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),c(e),a(e),r(e),o(e)}))};o.a.render(Object(h.jsx)(a.a.StrictMode,{children:Object(h.jsx)(Oe,{})}),document.getElementById("root")),ye()},71:function(e,t,n){},72:function(e,t,n){}},[[125,1,2]]]);
//# sourceMappingURL=main.25b0182c.chunk.js.map